2021-08-24 18:19:15 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.clients.FetchSessionHandler - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Node 1 sent an incremental fetch response with throttleTimeMs = 0 for session 276603895 with 1 response partition(s), 1 implied partition(s)
2021-08-24 18:19:15 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.c.consumer.internals.Fetcher - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Fetch READ_UNCOMMITTED at offset 16552 for partition kafka-streams-application-word-count-store-repartition-1 returned fetch data (error=NONE, highWaterMark=16579, lastStableOffset = -1, logStartOffset = 0, preferredReadReplica = absent, abortedTransactions = null, divergingEpoch =Optional.empty, recordsSizeInBytes=524)
2021-08-24 18:19:15 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Sending metadata request MetadataRequestData(topics=[MetadataRequestTopic(topicId=AAAAAAAAAAAAAAAAAAAAAA, name='kafka-streams-application-word-count-store-changelog')], allowAutoTopicCreation=true, includeClusterAuthorizedOperations=false, includeTopicAuthorizedOperations=false) to node kafka-broker-3:9092 (id: 3 rack: null)
2021-08-24 18:19:15 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Sending METADATA request with header RequestHeader(apiKey=METADATA, apiVersion=6, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer, correlationId=206) and timeout 30000 to node 3: MetadataRequestData(topics=[MetadataRequestTopic(topicId=AAAAAAAAAAAAAAAAAAAAAA, name='kafka-streams-application-word-count-store-changelog')], allowAutoTopicCreation=true, includeClusterAuthorizedOperations=false, includeTopicAuthorizedOperations=false)
2021-08-24 18:19:15 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Received METADATA response from node 3 for request with header RequestHeader(apiKey=METADATA, apiVersion=6, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer, correlationId=206): MetadataResponseData(throttleTimeMs=0, brokers=[MetadataResponseBroker(nodeId=2, host='kafka-broker-2', port=9092, rack=null), MetadataResponseBroker(nodeId=1, host='kafka-broker-1', port=9092, rack=null), MetadataResponseBroker(nodeId=3, host='kafka-broker-3', port=9092, rack=null)], clusterId='-P_dR6oYRceSycDAuepPbg', controllerId=3, topics=[MetadataResponseTopic(errorCode=0, name='kafka-streams-application-word-count-store-changelog', topicId=AAAAAAAAAAAAAAAAAAAAAA, isInternal=false, partitions=[MetadataResponsePartition(errorCode=0, partitionIndex=2, leaderId=2, leaderEpoch=-1, replicaNodes=[2], isrNodes=[2], offlineReplicas=[]), MetadataResponsePartition(errorCode=0, partitionIndex=1, leaderId=3, leaderEpoch=-1, replicaNodes=[3], isrNodes=[3], offlineReplicas=[]), MetadataResponsePartition(errorCode=0, partitionIndex=0, leaderId=1, leaderEpoch=-1, replicaNodes=[1], isrNodes=[1], offlineReplicas=[])], topicAuthorizedOperations=-2147483648)], clusterAuthorizedOperations=-2147483648)
2021-08-24 18:19:15 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG org.apache.kafka.clients.Metadata - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Updated cluster metadata updateVersion 4 to MetadataCache{clusterId='-P_dR6oYRceSycDAuepPbg', nodes={1=kafka-broker-1:9092 (id: 1 rack: null), 2=kafka-broker-2:9092 (id: 2 rack: null), 3=kafka-broker-3:9092 (id: 3 rack: null)}, partitions=[PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-repartition-1, leader=Optional[1], leaderEpoch=Optional.empty, replicas=1, isr=1, offlineReplicas=), PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-repartition-0, leader=Optional[2], leaderEpoch=Optional.empty, replicas=2, isr=2, offlineReplicas=), PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-changelog-2, leader=Optional[2], leaderEpoch=Optional.empty, replicas=2, isr=2, offlineReplicas=), PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-changelog-1, leader=Optional[3], leaderEpoch=Optional.empty, replicas=3, isr=3, offlineReplicas=), PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-repartition-2, leader=Optional[3], leaderEpoch=Optional.empty, replicas=3, isr=3, offlineReplicas=), PartitionMetadata(error=NONE, partition=kafka-streams-application-word-count-store-changelog-0, leader=Optional[1], leaderEpoch=Optional.empty, replicas=1, isr=1, offlineReplicas=)], controller=kafka-broker-3:9092 (id: 3 rack: null)}
2021-08-24 18:19:15 [kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1] INFO  c.m.d.k.s.s.r.i.KafkaStreamsRunner - Sending to topic twitter-analytics-topic, word ?ukur - count 1
2021-08-24 18:19:15 [kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1] DEBUG i.c.k.s.client.rest.RestService - Sending POST with input {"schema":"{\"type\":\"record\",\"name\":\"TwitterAnalyticsAvroModel\",\"namespace\":\"com.microservices.demo.kafka.avro.model\",\"fields\":[{\"name\":\"word\",\"type\":[\"null\",{\"type\":\"string\",\"avro.java.string\":\"String\"}]},{\"name\":\"wordCount\",\"type\":[\"null\",\"long\"]},{\"name\":\"createdAt\",\"type\":[\"null\",\"long\"],\"logicalType\":[\"null\",\"date\"]}]}"} to http://schema-registry:8081/subjects/twitter-analytics-topic-value/versions
2021-08-24 18:19:16 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Sending PRODUCE request with header RequestHeader(apiKey=PRODUCE, apiVersion=6, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer, correlationId=207) and timeout 30000 to node 2: {acks=1,timeout=30000,partitionSizes=[kafka-streams-application-word-count-store-changelog-2=82]}
2021-08-24 18:19:16 [kafka-producer-network-thread | kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] DEBUG o.apache.kafka.clients.NetworkClient - [Producer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer] Received PRODUCE response from node 2 for request with header RequestHeader(apiKey=PRODUCE, apiVersion=6, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-producer, correlationId=207): ProduceResponseData(responses=[TopicProduceResponse(name='kafka-streams-application-word-count-store-changelog', partitionResponses=[PartitionProduceResponse(index=2, errorCode=0, baseOffset=0, logAppendTimeMs=-1, logStartOffset=0, recordErrors=[], errorMessage=null)])], throttleTimeMs=0)
2021-08-24 18:19:18 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Sending Heartbeat request with generation 2 and member id kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer-925fda61-e500-4f8a-b82e-132185c5365e to coordinator kafka-broker-1:9092 (id: 2147483646 rack: null)
2021-08-24 18:19:18 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.apache.kafka.clients.NetworkClient - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Sending HEARTBEAT request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=2, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, correlationId=863) and timeout 30000 to node 2147483646: HeartbeatRequestData(groupId='kafka-streams-application', generationId=2, memberId='kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer-925fda61-e500-4f8a-b82e-132185c5365e', groupInstanceId=null)
2021-08-24 18:19:18 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.apache.kafka.clients.NetworkClient - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Received HEARTBEAT response from node 2147483646 for request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=2, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, correlationId=863): HeartbeatResponseData(throttleTimeMs=0, errorCode=0)
2021-08-24 18:19:18 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Received successful Heartbeat response
2021-08-24 18:19:21 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Sending Heartbeat request with generation 2 and member id kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer-925fda61-e500-4f8a-b82e-132185c5365e to coordinator kafka-broker-1:9092 (id: 2147483646 rack: null)
2021-08-24 18:19:21 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.apache.kafka.clients.NetworkClient - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Sending HEARTBEAT request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=2, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, correlationId=864) and timeout 30000 to node 2147483646: HeartbeatRequestData(groupId='kafka-streams-application', generationId=2, memberId='kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer-925fda61-e500-4f8a-b82e-132185c5365e', groupInstanceId=null)
2021-08-24 18:19:21 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.apache.kafka.clients.NetworkClient - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Received HEARTBEAT response from node 2147483646 for request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=2, clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, correlationId=864): HeartbeatResponseData(throttleTimeMs=0, errorCode=0)
2021-08-24 18:19:21 [kafka-coordinator-heartbeat-thread | kafka-streams-application] DEBUG o.a.k.c.c.i.AbstractCoordinator - [Consumer clientId=kafka-streams-application-711ffd56-0080-45f1-a18b-e150b957190c-StreamThread-1-consumer, groupId=kafka-streams-application] Received successful Heartbeat response
2021-08-24 18:19:21 [Catalina-utility-1] DEBUG o.a.catalina.session.ManagerBase - Start expire sessions StandardManager at 1629829161777 sessioncount 0
2021-08-24 18:19:21 [Catalina-utility-1] DEBUG o.a.catalina.session.ManagerBase - End expire sessions StandardManager processingTime 1 expired sessions: 0
